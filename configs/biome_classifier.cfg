[trainer]
@trainer=perceptron

[logging]
save_dir="checkpoints/biome_classifier"
save_epochs=1000
temp_save_epochs=1
mean_length=1024

[training]
batch_size=256
gradient_accumulation_steps=1
mixed_precision=fp16
epochs=20
epoch_steps=1024

[optimizer]
type=adam
kwargs={"betas": [0.9, 0.99]}

[lr_sched]
@lr_sched=cosine
lr=0.001
ref_nimg=5242880
warmup_nimg=262144

[ema]
sigma_rels=[0.05, 0.1]
update_every=1
checkpoint_every_num_steps=2048

[wandb]
project="generative_land"
tags=["64x64", "consistency"]
mode=disabled
save_code=true

[model]
@model=perceptron
in_dim=5
out_dim=31
hidden_dims=[64, 64, 64]
activation="silu"
final_activation="identity"
dropout=0.0
bias=true

[train_dataset]
@dataset=biome
elev_file=data/global/ETOPO_2022_v1_30s_N90W180_bed.tif
temp_file=data/global/wc2.1_30s_bio_1.tif
temp_std_file=data/global/wc2.1_30s_bio_4.tif
precip_file=data/global/wc2.1_30s_bio_12.tif
precip_std_file=data/global/wc2.1_30s_bio_15.tif
koppen_file=data/global/koppen_geiger_0p00833333.tif
length=1_000_000
seed=0

[dataloader_kwargs]
num_workers=0