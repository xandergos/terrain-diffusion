[trainer]
@trainer=perceptron

[logging]
save_dir="checkpoints/color_pred"
save_epochs=1000
temp_save_epochs=1
mean_length=1024

[training]
batch_size=256
gradient_accumulation_steps=1
mixed_precision=fp16
epochs=10
epoch_steps=128
loss=high_mae

[evaluation]
validate_epochs=1
validation_steps=1024

[optimizer]
type=adam
kwargs={"betas": [0.9, 0.99]}

[lr_sched]
@lr_sched=cosine
lr=0.001
ref_nimg=5242880
warmup_nimg=262144

[ema]
sigma_rels=[0.05, 0.1]
update_every=1
checkpoint_every_num_steps=128

[wandb]
project="generative_land"
tags=["64x64", "consistency"]
mode=disabled
save_code=true

[model]
@model=perceptron
in_dim=5
out_dim=3
hidden_dims=[128, 128]
activation="relu"
final_activation="identity"
dropout=0.5
random_ensembles=1
bias=true

[train_dataset]
@dataset=color
elev_file=data/global/ETOPO_2022_v1_30s_N90W180_bed.tif
temp_file=data/global/wc2.1_30s_bio_1.tif
temp_std_file=data/global/wc2.1_30s_bio_4.tif
precip_file=data/global/wc2.1_30s_bio_12.tif
precip_std_file=data/global/wc2.1_30s_bio_15.tif
color_file=data/global/world_shaded_43k.jpg
length=1_000_000
seed=0

[dataloader_kwargs]
num_workers=2